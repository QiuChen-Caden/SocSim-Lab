# SocSim Lab - 项目文档

> **版本**: v3.2 | **更新日期**: 2026-02-07

---

## 项目概述

**SocSim Lab** 是一个基于多智能体模拟（Agent-Based Modeling）的社交动态可视化平台，采用前后端分离架构，旨在帮助研究人员、数据科学家和策略制定者直观地研究社会动态、舆情传播和群体行为。

### 核心特性

- 🚀 **完整后端集成**：FastAPI + SQLite + WebSocket
- 👥 **真实用户画像**：30 个 Twitter 用户数据，包含心理测量模型
- 🎨 **高性能渲染**：PixiJS 8.x 支持 200-50000 智能体可视化
- 📊 **数据可视化**：ECharts 图表、热力图、关系图谱
- 🎮 **实时干预**：自然语言命令控制模拟
- ⏮️ **时间回放**：完整事件流的时间轴功能
- 🤖 **LLM 智能体**：支持多种大语言模型驱动的自主智能体行为

### 技术架构

```
┌─────────────────────────────────────────────────────────┐
│                    前端 (Frontend)                       │
├─────────────────────────────────────────────────────────┤
│ React 19 + TypeScript + Vite + PixiJS + ECharts         │
└──────────────────────┬──────────────────────────────────┘
                       │ REST API + WebSocket
┌──────────────────────┴──────────────────────────────────┐
│                    后端 (Backend)                        │
├─────────────────────────────────────────────────────────┤
│ FastAPI + SQLAlchemy + SQLite + NetworkX + SciPy        │
└─────────────────────────────────────────────────────────┘
```

---

## 核心功能

### 1. 世界视图 (World View) 🌍
- **PixiJS 8.x 渲染**：支持 200-50000 智能体流畅展示
- **双视图模式**：
  - 微观模式：显示单个智能体，颜色表示情绪
  - 宏观模式：网格热力图展示群体情绪分布
- **智能交互**：缩放、拖拽、惯性移动、点击选择
- **智能体检查器**：完整画像信息（身份、心理测量、行为特征）
- **Agent Graph**：智能体关系图谱（ego network / sample graph）

### 2. 工作台 (Workbench) 🛠️
- **Design 设计阶段**：场景配置、约束设置、采样配置、LLM 配置
- **Run 运行阶段**：启动/暂停、流式日志、书签标记
- **Intervene 干预阶段**：自然语言命令、干预记录
- **Analyze 分析阶段**：宏观指标、ECharts 图表、数据导出

### 3. 信息流 (Feed) 📰
- **帖子展示**：作者、情绪、点赞等信息
- **多种排序**：最新优先、最多点赞、最具争议
- **指标仪表盘**：基础统计、参与度、情绪分布、极化指数
- **交互操作**：发布帖子、点赞、跳转

### 4. 回放 (Replay) ⏮️
- **时间轴控制**：播放/暂停、速度调节、帧级控制
- **事件筛选**：agent_action、message、intervention、alert、bookmark
- **快照系统**：保存/加载任意时刻状态
- **书签管理**：标记关键时刻、添加备注

---

## 技术栈

| 类别 | 技术 | 版本 | 用途 |
|------|------|------|------|
| **前端** |
| 框架 | React | 19.3.0 | UI 框架 |
| 语言 | TypeScript | 5.8.3 | 类型系统 |
| 构建 | Vite | 7.4.0 | 构建工具 |
| 渲染 | PixiJS | 8.15.0 | 2D 渲染引擎 |
| 视口 | pixi-viewport | 6.0.3 | 缩放/拖拽 |
| 图表 | ECharts | 6.x | 数据可视化 |
| **后端** |
| 框架 | FastAPI | 0.115.0 | Web 框架 |
| ORM | SQLAlchemy | - | 数据库 ORM |
| 数据库 | SQLite3 | - | 数据存储（嵌入式） |
| 实时通信 | WebSocket | - | 双向通信 |
| 算法 | NetworkX | - | 网络分析 |
| 算法 | SciPy | - | 布局算法 |
| **AI 集成** |
| 模拟框架 | OASIS | - | 社交模拟平台 |
| LLM 框架 | CAMEL | - | 多智能体 LLM 框架 |
| 支持模型 | OpenAI/DeepSeek/vLLM | - | 多种 LLM 提供商 |

---

## 数据模型

### Twitter Personas

项目使用 30 个真实提取的 Twitter 用户画像，数据维度：

- **身份信息**：用户名、年龄、性别、位置、职业、专业领域
- **心理测量**：
  - 大五人格（Big Five）：开放性、尽责性、外向性、宜人性、神经质
  - 道德基础理论（MFT）：关怀、公平、忠诚、权威、神圣
- **社会地位**：影响力层级、经济水平、社会资本
- **行为画像**：发帖频率、时段分布、修辞风格
- **认知状态**：核心情绪、议题立场

---

## LLM 智能体配置

SocSim Lab v3.1+ 新增 LLM 驱动的智能体功能，支持大语言模型控制智能体行为。

### 支持的 LLM 提供商

| 提供商 | 模型示例 | 说明 |
|--------|----------|------|
| OpenAI | gpt-4o-mini, gpt-4o | 标准 OpenAI API |
| DeepSeek | deepseek-chat | DeepSeek API |
| vLLM | 自定义模型 | 本地或私有部署 |
| Stub | STUB | 调试模式，无实际调用 |

### 配置参数

| 参数 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `llmEnabled` | boolean | false | 是否启用 LLM |
| `llmProvider` | string | "deepseek" | LLM 提供商 |
| `llmModel` | string | "deepseek-chat" | 模型名称 |
| `llmBaseUrl` | string | "https://api.deepseek.com/v1" | API 地址 |
| `llmApiKey` | string | "" | API 密钥 |
| `llmTemperature` | float | 0.7 | 生成温度 (0-1) |
| `llmMaxTokens` | int | 512 | 最大生成令牌数 |
| `llmTopP` | float | 1.0 | Top-p 采样参数 |
| `llmActiveAgents` | int | 3 | 活跃 LLM 智能体数量 |
| `llmTimeoutMs` | int | 30000 | 请求超时时间 (毫秒) |

### 配置方式

**前端配置**：在工作台的 Design 标签中设置 LLM 参数

**后端配置**：通过 `PATCH /api/state` 更新配置

**环境变量**：在 `backend/.env` 中设置默认值

---

## 适用场景

- **学术研究**：研究社交媒体极化现象、信息传播模式、群体行为
- **教学演示**：展示社会动态演化过程，直观教学工具
- **策略分析**：评估政策宣传效果，对比不同干预方案
- **科普展示**：向公众直观展示社会系统复杂性

---

## 项目状态

当前版本 **v3.2**，处于 **生产就绪阶段**：

| 模块 | 完成度 | 说明 |
|------|--------|------|
| 前端 UI | 100% | 4 个核心页面全部实现 |
| 后端 API | 100% | FastAPI 服务完整实现 |
| 数据集成 | 100% | Twitter Personas 已导入 |
| WebSocket | 100% | 实时双向通信 |
| 数据持久化 | 100% | SQLite + 快照系统 |
| OASIS 集成 | 100% | 社交模拟框架集成完成 |
| LLM 智能体 | 100% | 多模型支持，可配置运行 |

**开发模式**：支持 Mock 模式和真实 API 模式切换

---

## 文档索引

| 文档 | 描述 |
|------|------|
| [PRD](./PRD.md) | 产品需求文档 |
| [UI Inventory](./ui-inventory.md) | UI 组件清单 |
| [API](./API.md) | 后端 API 规范 |
| [LLM Integration](./LLM-Integration.md) | LLM 集成指南 |

---

**文档位置**: `docs/README.md`
**最后更新**: 2026-02-07
